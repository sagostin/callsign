# Fail2Ban configuration file for CallSign SIP protection
# Matches FreeSWITCH log entries for SIP brute force attempts

[Definition]

# Patterns matched:
# 1. Can't find user from IP (unknown extension attempts)
# 2. SIP auth failure (REGISTER) - wrong password
# 3. SIP auth failure (INVITE) - wrong password on calls
# 4. IP rejected by ACL
# 5. Digest auth failure on register
# 6. mod_verto WebSocket setup failure (probing/scanning)

failregex = \[WARNING\] sofia_reg.c:\d+ Can't find user \[.*\] from <HOST>
            \[WARNING\] sofia_reg.c:\d+ SIP auth failure \(REGISTER\) on sofia profile '.*' for \[.*\] from ip <HOST>
            \[WARNING\] sofia_reg.c:\d+ SIP auth failure \(INVITE\) on sofia profile '.*' for \[.*\] from ip <HOST>
            \[WARNING\] sofia_reg.c:\d+ IP <HOST> Rejected by register acl
            \[NOTICE\] switch_ivr.c:\d+ DIGEST auth failed on register to <HOST>
            \[NOTICE\] mod_verto.c:\d+ <HOST>:\d+ WS SETUP FAILED

ignoreregex =

