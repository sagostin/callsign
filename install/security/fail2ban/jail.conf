# CallSign Fail2ban Configuration
# Copy to /etc/fail2ban/jail.local
# Based on FusionPBX fail2ban patterns

[DEFAULT]
ignoreip = 127.0.0.1/8 ::1 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16
bantime  = 3600
findtime = 600
maxretry = 5

[ssh]
enabled  = true
port     = 22
filter   = sshd
logpath  = /var/log/auth.log
action   = iptables-allports[name=sshd, protocol=all]
maxretry = 6
bantime  = 86400

[freeswitch]
enabled  = true
port     = 5060:5091
filter   = freeswitch
logpath  = /var/log/freeswitch/freeswitch.log
action   = iptables-allports[name=freeswitch, protocol=all]
maxretry = 10
bantime  = 3600

[freeswitch-ip]
enabled  = true
port     = 5060:5091
filter   = freeswitch-ip
logpath  = /var/log/freeswitch/freeswitch.log
action   = iptables-allports[name=freeswitch-ip, protocol=all]
maxretry = 1
bantime  = 86400

[sip-auth-failure]
enabled  = true
port     = 5060:5091
filter   = sip-auth-failure
logpath  = /var/log/freeswitch/freeswitch.log
action   = iptables-allports[name=sip-auth-failure, protocol=all]
maxretry = 6
bantime  = 7200

[callsign-api]
enabled  = true
port     = 80,443,8080
filter   = callsign-api
logpath  = /var/log/callsign/api.log
action   = iptables-allports[name=callsign-api, protocol=all]
maxretry = 10
bantime  = 3600

[nginx-dos]
enabled  = true
port     = 80,443
filter   = nginx-dos
logpath  = /var/log/nginx/access*.log
action   = iptables-allports[name=nginx-dos, protocol=all]
maxretry = 800
bantime  = 86400
