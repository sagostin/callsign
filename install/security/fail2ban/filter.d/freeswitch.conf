# Fail2Ban filter for FreeSWITCH authentication failures
# Copy to /etc/fail2ban/filter.d/freeswitch.conf

[Definition]
failregex = \[WARNING\] sofia_reg\.c:\d+ SIP auth failure \(REGISTER\) on sofia profile \'[^']+\' for \[[^\]]+\] from ip <HOST>
            \[WARNING\] sofia_reg\.c:\d+ SIP auth failure \(INVITE\) on sofia profile \'[^']+\' for \[[^\]]+\] from ip <HOST>
            \[WARNING\] sofia_reg\.c:\d+ Can't find user \[[^\]]+@[^\]]+\] from <HOST>
            \[WARNING\] sofia_reg\.c:\d+ Authorization \w+ on sofia profile \'[^']+\' for \[[^\]]+\] from ip <HOST>

ignoreregex =
