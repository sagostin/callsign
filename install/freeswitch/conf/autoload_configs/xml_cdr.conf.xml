<?xml version="1.0" encoding="UTF-8"?>
<!--
  CallSign XML CDR Configuration
  
  Posts Call Detail Records to the CallSign API after each call ends.
  CDRs are stored in PostgreSQL and optionally synced to ClickHouse.
  
  IMPORTANT: Update the url and credentials to match your CallSign API deployment.
-->
<configuration name="xml_cdr.conf" description="CallSign XML CDR Logger">
  <settings>
    <!-- 
      CallSign CDR endpoint - receives XML CDR after each call
      Update this URL to match your deployment
    -->
    <param name="url" value="http://127.0.0.1:8080/freeswitch/cdr"/>
    
    <!-- 
      API authentication - uses the FREESWITCH_API_KEY from .env
      Format: username:apikey
    -->
    <param name="cred" value="freeswitch:CHANGE_ME_TO_YOUR_API_KEY"/>
    <param name="auth-scheme" value="basic"/>
    
    <!-- Retry settings for failed CDR posts -->
    <param name="retries" value="3"/>
    <param name="delay" value="5"/>
    
    <!-- Log to disk as backup if API is down -->
    <param name="log-http-and-disk" value="true"/>
    <param name="log-dir" value="/var/log/freeswitch/cdr"/>
    <param name="err-log-dir" value="/var/log/freeswitch/cdr/errors"/>
    
    <!-- B-leg logging (set to true for full call tracking) -->
    <param name="log-b-leg" value="false"/>
    
    <!-- Prefix A-leg files with "a_" for identification -->
    <param name="prefix-a-leg" value="true"/>
    
    <!-- URL-encode the XML data -->
    <param name="encode" value="true"/>
    
    <!-- Disable Expect: 100-continue for compatibility -->
    <param name="disable-100-continue" value="true"/>
  </settings>
</configuration>
